generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "sqlserver"
  url      = env("DATABASE_URL")
}

model Abonement {
  Id                String              @id(map: "PK_Abonements") @db.UniqueIdentifier
  Title             String?             @db.NVarChar(Max)
  Validity          String?             @db.NVarChar(Max)
  VisitingTime      String?             @db.NVarChar(Max)
  Photo             String?             @db.NVarChar(Max)
  Price             Int?
  AbonementsService AbonementsService[]
  Order             Order[]
}

model AbonementsService {
  AbonementsId String    @db.UniqueIdentifier
  ServicesId   String    @db.UniqueIdentifier
  Abonement    Abonement @relation(fields: [AbonementsId], references: [Id], onDelete: Cascade, onUpdate: NoAction, map: "FK_AbonementsServices_Abonements_AbonementsId")
  Service      Service   @relation(fields: [ServicesId], references: [Id], onDelete: Cascade, onUpdate: NoAction, map: "FK_AbonementsServices_Services_ServicesId")

  @@id([AbonementsId, ServicesId], map: "PK_AbonementsServices")
  @@index([ServicesId], map: "IX_AbonementsServices_ServicesId")
}

model Client {
  Id               String             @id(map: "PK_Clients") @db.UniqueIdentifier
  FirstName        String             @db.NVarChar(Max)
  LastName         String             @db.NVarChar(Max)
  Email            String             @db.NVarChar(Max)
  Role             Int
  Password         String             @db.NVarChar(Max)
  Photo            String?            @default("N'", map: "DF__Clients__Photo__625A9A57") @db.NVarChar(Max)
  Comment          Comment[]
  Order            Order[]
  refresh_sessions refresh_sessions[]
}

model Comment {
  Id          String @id(map: "PK_Comments") @db.UniqueIdentifier
  CommentBody String @db.NVarChar(Max)
  ClientsId   String @db.UniqueIdentifier
  CouchesId   String @db.UniqueIdentifier
  Client      Client @relation(fields: [ClientsId], references: [Id], onDelete: Cascade, onUpdate: NoAction, map: "FK_Comments_Clients_ClientsId")
  Couche      Couche @relation(fields: [CouchesId], references: [Id], onDelete: Cascade, onUpdate: NoAction, map: "FK_Comments_Couches_CouchesId")

  @@index([ClientsId], map: "IX_Comments_ClientsId")
  @@index([CouchesId], map: "IX_Comments_CouchesId")
}

model Couche {
  Id             String           @id(map: "PK_Couches") @db.UniqueIdentifier
  Name           String           @db.NVarChar(Max)
  Description    String           @db.NVarChar(Max)
  Photo          String           @default("N'", map: "DF__Couches__Photo__59FA5E80") @db.NVarChar(Max)
  Comment        Comment[]
  CouchesService CouchesService[]
}

model CouchesService {
  CouchesId  String  @db.UniqueIdentifier
  ServicesId String  @db.UniqueIdentifier
  Couche     Couche  @relation(fields: [CouchesId], references: [Id], onDelete: Cascade, onUpdate: NoAction, map: "FK_CouchesServices_Couches_CouchesId")
  Service    Service @relation(fields: [ServicesId], references: [Id], onDelete: Cascade, onUpdate: NoAction, map: "FK_CouchesServices_Services_ServicesId")

  @@id([CouchesId, ServicesId], map: "PK_CouchesServices")
  @@index([ServicesId], map: "IX_CouchesServices_ServicesId")
}

model Order {
  Id           String     @id(map: "PK_Orders") @db.UniqueIdentifier
  AbonementsId String?    @db.UniqueIdentifier
  ClientsId    String?    @db.UniqueIdentifier
  Status       Int        @default(0, map: "DF__Orders__Status__5AEE82B9")
  Abonement    Abonement? @relation(fields: [AbonementsId], references: [Id], onDelete: NoAction, onUpdate: NoAction, map: "FK_Orders_Abonements_AbonementsId")
  Client       Client?    @relation(fields: [ClientsId], references: [Id], onDelete: NoAction, onUpdate: NoAction, map: "FK_Orders_Clients_ClientsId")

  @@index([AbonementsId], map: "IX_Orders_AbonementsId")
  @@index([ClientsId], map: "IX_Orders_ClientsId")
}

model refresh_sessions {
  id            String @id(map: "PK__refresh___3213E83F1567B902") @db.UniqueIdentifier
  user_id       String @db.UniqueIdentifier
  refresh_token String @db.VarChar(400)
  finger_print  String @db.VarChar(32)
  Client        Client @relation(fields: [user_id], references: [Id], onDelete: Cascade, onUpdate: NoAction, map: "FK__refresh_s__user___4A8310C6")
}

model Service {
  Id                String              @id(map: "PK_Services") @db.UniqueIdentifier
  Title             String?             @db.NVarChar(Max)
  Phote             String?             @default("N'", map: "DF__Services__Phote__3B40CD36") @db.NVarChar(Max)
  AbonementsService AbonementsService[]
  CouchesService    CouchesService[]
}
